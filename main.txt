This are changes from branch2.